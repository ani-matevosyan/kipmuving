$(document).ready(function(){function g(){$.ajax({type:"GET",url:"/activities/getsuprogram",data:"",success:function(k){$("#program_activities").text(k.data.offers);$("#program_activities").attr("data-activities",k.data.offers);$("#program_persons").text(k.data.persons);$("#program_total").text(k.data.total)},error:function(){location.reload()}})}if($("#calendar").length){var e=$("#calendar").attr("data-date");var a=$("#calendar").attr("data-lang");var j,b=$(window).width();if(b>=992){j=5}else{if(b<991&&b>600){j=3}else{j=2}}if(a==="es_ES"){a="es"}jQuery("#calendar").fullCalendar({lang:a,header:{left:"prev,next today",center:"title",right:""},defaultView:"agendaFourDay",views:{agendaFourDay:{type:"agenda",duration:{days:j},buttonText:"5 days",columnFormat:"ddd D/M"}},allDaySlot:false,defaultDate:e,editable:false,eventLimit:true,events:"/calendar/data",eventOverlap:true,eventRender:function(l,k){k.data("duplicate",l.duplicate);k.append("<br>");k.append('<a href="#" class="move prev" data-oid="'+l.id+'"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></a>');k.append('<a href="#" class="move next" data-oid="'+l.id+'"><span class="glyphicon glyphicon-chevron-right pull-right" aria-hidden="true"></span></a>');k.append("<br>");if(l.agency_name!=undefined){k.append('<div class="agency-name">'+l.agency_name+"</div>")}else{k.append("<br>")}k.append('<div class="hours"><i class="glyphicon glyphicon-time"></i> '+l.hours+" hrs ("+l.start_time+" a "+l.end_time+")</div>");if(l.persons!=undefined){k.append('<div class="persona"><i class="glyphicon glyphicon-user"></i> '+l.persons+" persona</div>")}k.append("<br>");k.append('<a href="#" class="delete" data-oid="'+l.id+'"><span class="glyphicon glyphicon-remove pull-right" aria-hidden="true"></span></a>')},eventAfterAllRender:function(k){jQuery(".btn-reservar").attr("href","/reserve");jQuery(".alert-overlap").hide();$.each($(".fc-event"),function(l,m){if($(m).data("duplicate")){$(".alert-overlap").show();$(".btn-reservar").removeAttr("href")}})}})}jQuery(document).on("click",".fc-event.cal-offer .move",function(m){m.preventDefault();var l=jQuery(this).data("oid");var k=jQuery(this).hasClass("prev")?"prev":jQuery(this).hasClass("next")?"next":"";$.ajax({type:"POST",url:"/calendar/process",data:{_token:$('meta[name="csrf-token"]').attr("content"),oid:l,dir:k},success:function(n){jQuery("#calendar").fullCalendar("refetchEvents")}})});jQuery(document).on("click",".fc-event.cal-offer .delete",function(l){l.preventDefault();var k=jQuery(this).data("oid");$("#delete-modal .btn-confirm").data("oid",k);$("#delete-modal").modal("show")});jQuery("#delete-modal .btn-confirm").on("click",function(l){l.preventDefault();var k=jQuery(this).data("oid");$("#delete-modal").modal("hide");$.ajax({type:"POST",url:"/offer/remove",data:{_token:$('meta[name="csrf-token"]').attr("content"),oid:k},success:function(){jQuery("#calendar").fullCalendar("refetchEvents");g();$(".offers-list li").each(function(m){if(m===k){$(this).remove()}});c()}})});function h(k){var l=$("#calendar").fullCalendar("clientEvents");for(i in l){if(l[i].id!=k.id){if(!(Date(l[i].start)>=Date(k.end)||Date(l[i].end)<=Date(k.start))){return true}}}return false}var f=false;$("#generate-link").click(function(m){m.preventDefault();var l=$(this).parent().find("input"),k=$(this);if(f){l.select();document.execCommand("copy")}else{$.ajax({type:"POST",url:"/proposals/save",data:{_token:$('meta[name="csrf-token"]').attr("content")},success:function(n){l.val(n).slideDown();f=true;k.text("Copy")}})}});function c(){var l=0;var k;$(".offers-list li").each(function(){var m=($(this).find("span").text());l+=parseInt(m.split(".").join(""))});$(".total .totalprice p").text(Number(l).toLocaleString("de-DE"));k=parseInt(l*0.1);$(".total .discount p").text(Number(k).toLocaleString("de-DE"))}jQuery(".offers-list").on("click","a",function(){var l=$(this).parent().prevAll().length;var k=$(this).parent();$.ajax({type:"POST",url:"/offer/remove",data:{_token:$('meta[name="csrf-token"]').attr("content"),oid:l},success:function(){k.remove();g();if($(".offers-list li").length===0){$("section.widget.summary").slideUp()}if(window.location.pathname==="/calendar"){c();jQuery("#calendar").fullCalendar("refetchEvents")}if(window.location.pathname==="/reserve"){location.reload()}},error:function(){location.reload()}});return false});var d;$(".delete_offer a").click(function(k){d=$(this).attr("href");k.preventDefault();$("#myModal").modal()});$("#confirm_cancel").click(function(k){k.preventDefault();window.location.href=d})});