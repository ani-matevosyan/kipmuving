$(document).ready(function(){if($("#calendar").length){var c=$("#calendar").attr("data-date");var b=$("#calendar").attr("data-lang");var f,e=$(window).width();if(e>=992){f=5}else{if(e<991&&e>600){f=3}else{f=2}}if(b==="es_ES"){b="es"}jQuery("#calendar").fullCalendar({lang:b,header:{left:"prev,next today",center:"title",right:""},defaultView:"agendaFourDay",views:{agendaFourDay:{type:"agenda",duration:{days:f},buttonText:"5 days",columnFormat:"ddd D/M"}},allDaySlot:false,defaultDate:c,editable:false,eventLimit:true,events:"/calendar/data",eventOverlap:true,eventRender:function(k,j){j.data("duplicate",k.duplicate);j.append("<br>");j.append('<a href="#" class="move prev" data-oid="'+k.id+'"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span></a>');j.append('<a href="#" class="move next" data-oid="'+k.id+'"><span class="glyphicon glyphicon-chevron-right pull-right" aria-hidden="true"></span></a>');j.append("<br>");if(k.agency_name!=undefined){j.append('<div class="agency-name">'+k.agency_name+"</div>")}else{j.append("<br>")}j.append('<div class="hours"><i class="glyphicon glyphicon-time"></i> '+k.hours+" hrs ("+k.start_time+" a "+k.end_time+")</div>");if(k.persons!=undefined){j.append('<div class="persona"><i class="glyphicon glyphicon-user"></i> '+k.persons+" persona</div>")}j.append("<br>");j.append('<a href="#" class="delete" data-oid="'+k.id+'"><span class="glyphicon glyphicon-remove pull-right" aria-hidden="true"></span></a>')},eventAfterAllRender:function(j){jQuery(".btn-reservar").attr("href","/reserve");jQuery(".alert-overlap").hide();$.each($(".fc-event"),function(k,l){if($(l).data("duplicate")){$(".alert-overlap").show();$(".btn-reservar").removeAttr("href")}})}})}jQuery(document).on("click",".fc-event.cal-offer .move",function(l){l.preventDefault();var k=jQuery(this).data("oid");var j=jQuery(this).hasClass("prev")?"prev":jQuery(this).hasClass("next")?"next":"";$.ajax({type:"POST",url:"/calendar/process",data:{_token:$('meta[name="csrf-token"]').attr("content"),oid:k,dir:j},success:function(m){jQuery("#calendar").fullCalendar("refetchEvents")}})});jQuery(document).on("click",".fc-event.cal-offer .delete",function(k){k.preventDefault();var j=jQuery(this).data("oid");$("#delete-modal .btn-confirm").data("oid",j);$("#delete-modal").modal("show")});jQuery("#delete-modal .btn-confirm").on("click",function(k){k.preventDefault();var j=jQuery(this).data("oid");$("#delete-modal").modal("hide");$.ajax({type:"POST",url:"/offer/remove",data:{_token:$('meta[name="csrf-token"]').attr("content"),oid:j},success:function(){jQuery("#calendar").fullCalendar("refetchEvents");getsuprogram();$(".offers-list li").each(function(l){if(l===j){$(this).remove()}});g()}})});function h(j){var k=$("#calendar").fullCalendar("clientEvents");for(i in k){if(k[i].id!=j.id){if(!(Date(k[i].start)>=Date(j.end)||Date(k[i].end)<=Date(j.start))){return true}}}return false}var d=false;$("#generate-link").click(function(l){l.preventDefault();var k=$(this).parent().find("input"),j=$(this);if(d){k.select();document.execCommand("copy")}else{$.ajax({type:"POST",url:"/proposals/save",data:{_token:$('meta[name="csrf-token"]').attr("content")},success:function(m){k.val(m).slideDown();d=true;j.text("Copy")}})}});function g(){var k=0;var j;$(".offers-list li").each(function(){var l=($(this).find("span").text());k+=parseInt(l.split(".").join(""))});$(".total .totalprice p").text(Number(k).toLocaleString("de-DE"));j=parseInt(k*0.1);$(".total .discount p").text(Number(j).toLocaleString("de-DE"))}jQuery(".offers-list").on("click","a",function(){var k=$(this).parent().prevAll().length;var j=$(this).parent();$.ajax({type:"POST",url:"/offer/remove",data:{_token:$('meta[name="csrf-token"]').attr("content"),oid:k},success:function(){j.remove();getsuprogram();if($(".offers-list li").length===0){$("section.widget.summary").slideUp()}if(window.location.pathname==="/calendar"){g();jQuery("#calendar").fullCalendar("refetchEvents")}if(window.location.pathname==="/reserve"){location.reload()}},error:function(){location.reload()}});return false});var a;$(".delete_offer a").click(function(j){a=$(this).attr("href");j.preventDefault();$("#myModal").modal()});$("#confirm_cancel").click(function(j){j.preventDefault();window.location.href=a})});